{"ast":null,"code":"import csrfFetch, { storeCSRFToken } from \"./csrf\";\nimport { receiveLikes } from \"./likes\";\nimport { receiveComments } from './comments';\nimport { receiveUsers } from \"./user\";\nimport { receiveFollows } from \"./follows\";\n// consts \n\nconst RECEIVE_POST = \"api/RECEIVE_POST\";\nconst RECEIVE_POSTS = \"api/RECEIVE_POSTS\";\nconst REMOVE_POST = 'api/UPDATE_POST';\nconst RECEIVE_USER_POST = \"api/USERNAME/RECEIVE_POSTS\";\nconst CLEAR_POSTS = 'api/CLEAR_POSTS';\n\n// action types\n\nexport const receiveUserPosts = posts => ({\n  type: RECEIVE_USER_POST,\n  posts\n});\nexport const receivePost = post => ({\n  type: RECEIVE_POST,\n  post\n});\nexport const receivePosts = posts => ({\n  type: RECEIVE_POSTS,\n  posts\n});\nexport const deletePost = postId => ({\n  type: REMOVE_POST,\n  postId\n});\nexport const clearPosts = () => ({\n  type: CLEAR_POSTS\n});\n//getter\n\nexport const userPosts = username => state => {\n  return state.posts ? Object.values(state.posts).filter(post => post.author.username === username) : null;\n};\n\n// thunk actions\n\nexport const fetchPosts = function (pagenumber, type) {\n  let user = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  return async dispatch => {\n    let response = await fetch(`/api/posts?page_number=${pagenumber}&type=${type}$user=`);\n    if (response.ok) {\n      const data = await response.json();\n      dispatch(receivePosts(data.posts));\n      dispatch(receiveUsers(data.users));\n      dispatch(receiveFollows(data.follows));\n      dispatch(receiveLikes(data.likes));\n      return data;\n    }\n  };\n};\nexport const fetchPost = postId => async dispatch => {\n  let response = await fetch(`/api/posts/${postId}`);\n  if (response.ok) {\n    const data = await response.json();\n    dispatch(receivePost(data.posts));\n    dispatch(receiveComments(data.comments));\n    dispatch(receiveLikes(data.likes));\n    return data;\n  }\n};\nexport const createPost = post => async dispatch => {\n  const newPost = await csrfFetch('/api/posts', {\n    method: 'POST',\n    body: post\n  });\n  if (newPost.ok) {\n    const data = await newPost.json();\n    dispatch(receivePost(data.posts));\n    dispatch(receiveComments(data.comments));\n    dispatch(receiveLikes(data.likes));\n    return data;\n  }\n};\nexport const updatePost = (formData, postid) => async dispatch => {\n  const post = await csrfFetch(`/api/posts/${postid}`, {\n    method: 'PATCH',\n    body: formData\n  });\n  if (post.ok) {\n    const data = await post.json();\n    dispatch(receivePost(data));\n    return data;\n  } else {\n    const error = await post.json();\n    throw new Error(error.message);\n  }\n};\nexport const removePost = postId => async dispatch => {\n  const post = await csrfFetch(`/api/posts/${postId}`, {\n    method: 'DELETE'\n  });\n  if (post.ok) {\n    dispatch(deletePost(postId));\n    // dispatch(receivePosts())\n  }\n};\n\n// posts reducer\n\nconst postsReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  const newState = {\n    ...state\n  };\n  switch (action.type) {\n    case RECEIVE_POST:\n      newState[action.post.id] = action.post;\n      return newState;\n    case RECEIVE_POSTS:\n      return {\n        ...newState,\n        ...action.posts\n      };\n    case REMOVE_POST:\n      delete newState[action.postId];\n      return newState;\n    case RECEIVE_USER_POST:\n      return {\n        ...action.posts\n      };\n    case CLEAR_POSTS:\n      return {};\n    default:\n      return newState;\n  }\n};\nexport default postsReducer;","map":{"version":3,"names":["csrfFetch","storeCSRFToken","receiveLikes","receiveComments","receiveUsers","receiveFollows","RECEIVE_POST","RECEIVE_POSTS","REMOVE_POST","RECEIVE_USER_POST","CLEAR_POSTS","receiveUserPosts","posts","type","receivePost","post","receivePosts","deletePost","postId","clearPosts","userPosts","username","state","Object","values","filter","author","fetchPosts","pagenumber","user","arguments","length","undefined","dispatch","response","fetch","ok","data","json","users","follows","likes","fetchPost","comments","createPost","newPost","method","body","updatePost","formData","postid","error","Error","message","removePost","postsReducer","action","newState","id"],"sources":["/Users/vincentpham/Documents/mumblr/frontend/src/store/posts.js"],"sourcesContent":["import csrfFetch, { storeCSRFToken } from \"./csrf\";\nimport { receiveLikes } from \"./likes\";\nimport {receiveComments} from './comments';\nimport { receiveUsers } from \"./user\";\nimport { receiveFollows } from \"./follows\";\n// consts \n\nconst RECEIVE_POST = \"api/RECEIVE_POST\";\nconst RECEIVE_POSTS = \"api/RECEIVE_POSTS\";\nconst REMOVE_POST = 'api/UPDATE_POST';\nconst RECEIVE_USER_POST = \"api/USERNAME/RECEIVE_POSTS\";\nconst CLEAR_POSTS = 'api/CLEAR_POSTS';\n\n// action types\n\nexport const receiveUserPosts = (posts) => ({\n    type: RECEIVE_USER_POST,\n    posts\n})\nexport const receivePost = (post) => ({\n    type: RECEIVE_POST,\n    post \n})\n\nexport const receivePosts = (posts) => ({\n    type: RECEIVE_POSTS,\n    posts\n})\n\nexport const deletePost = (postId) =>({\n    type: REMOVE_POST,\n    postId\n})\nexport const clearPosts = () => ({\n    type: CLEAR_POSTS\n})\n//getter\n\nexport const userPosts = (username) => (state) => {\n    return state.posts ? Object.values(state.posts).filter((post)=>post.author.username===username) : null;\n}\n\n// thunk actions\n\nexport const fetchPosts = (pagenumber,type,user=0) => async(dispatch) =>{\n    let response = await fetch(`/api/posts?page_number=${pagenumber}&type=${type}$user=`)\n    if (response.ok){\n    const data = await response.json();\n    dispatch(receivePosts(data.posts));\n    dispatch(receiveUsers(data.users));\n    dispatch(receiveFollows(data.follows));\n    dispatch(receiveLikes(data.likes));\n    return data\n    }\n}\n\nexport const fetchPost = (postId) => async(dispatch)=>{\n    let response = await fetch(`/api/posts/${postId}`);\n\n    if (response.ok){\n    const data = await response.json();\n    dispatch(receivePost(data.posts));\n    dispatch(receiveComments(data.comments));\n    dispatch(receiveLikes(data.likes));\n    return data;\n    }\n} \n\nexport const createPost = (post) => async(dispatch) =>{\n    const newPost = await csrfFetch('/api/posts',{\n        method:'POST',\n        body: post\n    });\n    if (newPost.ok){\n    const data = await newPost.json();\n    dispatch(receivePost(data.posts));\n    dispatch(receiveComments(data.comments));\n    dispatch(receiveLikes(data.likes));\n    return data;\n    }\n}\n\nexport const updatePost = (formData,postid)=> async(dispatch) => {\n   \n    const post = await csrfFetch(`/api/posts/${postid}`,{\n        method:'PATCH',\n        body: formData\n    });\n    if (post.ok){\n        const data = await post.json();\n        dispatch(receivePost(data));\n        return data;\n    } else{\n        const error = await post.json();\n        throw new Error(error.message)\n    }\n}\n\nexport const removePost = postId => async dispatch =>{\n    const post = await csrfFetch(`/api/posts/${postId}`, {\n        method: 'DELETE'\n    });\n    if (post.ok){\n        dispatch(deletePost(postId))\n        // dispatch(receivePosts())\n    }\n};\n\n// posts reducer\n\nconst postsReducer = (state={},action)=>{\n    const newState={...state};\n    switch (action.type) {\n        case RECEIVE_POST:\n            newState[action.post.id] = action.post;\n            return newState;\n        case RECEIVE_POSTS:\n            return {...newState,...action.posts};\n        case REMOVE_POST:\n            delete newState[action.postId];\n            return newState;\n        case RECEIVE_USER_POST:\n            return {...action.posts};\n        case CLEAR_POSTS:\n            return {};\n        default:\n            return newState;\n    }\n}\nexport default postsReducer;\n\n    \n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}