{"ast":null,"code":"const csrfFetch = async (url, options) => {\n  options.method ||= 'GET';\n  options.headers ||= {};\n  if (options.method.toUpperCase() !== 'GET') {\n    options.headers['Content-Type'] = options.headers['Content-Type'] || 'application/json';\n    options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n  }\n\n  // initial fetch \n  const res = await fetch(url, options);\n  if (res.status >= 400) throw res;\n  // returns promise for the action\n\n  return res;\n};\nexport const storeCSRFToken = response => {\n  const csrfToken = response.headers.get('X-CSRF-Token');\n  if (csrfToken) sessionStorage.setItem(\"X-CSRF-Token\", csrfToken);\n};\nexport const restoreCSRF = async () => {\n  const res = await csrfFetch('/api/session');\n  storeCSRFToken(res);\n  return res;\n};\nexport default csrfFetch;","map":{"version":3,"names":["csrfFetch","url","options","method","headers","toUpperCase","sessionStorage","getItem","res","fetch","status","storeCSRFToken","response","csrfToken","get","setItem","restoreCSRF"],"sources":["/Users/vincentpham/Documents/GitHub/fullstack/frontend_react/frontend/src/store/csrf.js"],"sourcesContent":["\nconst csrfFetch = async(url, options) => {\n    options.method ||= 'GET';\n    options.headers ||= {};\n\n    if (options.method.toUpperCase()!=='GET'){\n        options.headers['Content-Type'] = options.headers['Content-Type'] || 'application/json';\n        options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n    }\n\n    // initial fetch \n    const res = await fetch(url, options);\n\n    if (res.status>=400) throw res; \n    // returns promise for the action\n\n    return res;\n}\nexport const storeCSRFToken = (response) => {\n    const csrfToken = response.headers.get('X-CSRF-Token');\n    if (csrfToken) sessionStorage.setItem(\"X-CSRF-Token\",csrfToken);\n}\nexport const restoreCSRF = async()=>{\n    const res = await csrfFetch('/api/session')\n    storeCSRFToken(res);\n    return res;\n}\n\nexport default csrfFetch;"],"mappings":"AACA,MAAMA,SAAS,GAAG,MAAAA,CAAMC,GAAG,EAAEC,OAAO,KAAK;EACrCA,OAAO,CAACC,MAAM,KAAK,KAAK;EACxBD,OAAO,CAACE,OAAO,KAAK,CAAC,CAAC;EAEtB,IAAIF,OAAO,CAACC,MAAM,CAACE,WAAW,CAAC,CAAC,KAAG,KAAK,EAAC;IACrCH,OAAO,CAACE,OAAO,CAAC,cAAc,CAAC,GAAGF,OAAO,CAACE,OAAO,CAAC,cAAc,CAAC,IAAI,kBAAkB;IACvFF,OAAO,CAACE,OAAO,CAAC,cAAc,CAAC,GAAGE,cAAc,CAACC,OAAO,CAAC,cAAc,CAAC;EAC5E;;EAEA;EACA,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAACR,GAAG,EAAEC,OAAO,CAAC;EAErC,IAAIM,GAAG,CAACE,MAAM,IAAE,GAAG,EAAE,MAAMF,GAAG;EAC9B;;EAEA,OAAOA,GAAG;AACd,CAAC;AACD,OAAO,MAAMG,cAAc,GAAIC,QAAQ,IAAK;EACxC,MAAMC,SAAS,GAAGD,QAAQ,CAACR,OAAO,CAACU,GAAG,CAAC,cAAc,CAAC;EACtD,IAAID,SAAS,EAAEP,cAAc,CAACS,OAAO,CAAC,cAAc,EAACF,SAAS,CAAC;AACnE,CAAC;AACD,OAAO,MAAMG,WAAW,GAAG,MAAAA,CAAA,KAAS;EAChC,MAAMR,GAAG,GAAG,MAAMR,SAAS,CAAC,cAAc,CAAC;EAC3CW,cAAc,CAACH,GAAG,CAAC;EACnB,OAAOA,GAAG;AACd,CAAC;AAED,eAAeR,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}