{"ast":null,"code":"import csrfFetch from \"./csrf\";\nimport { createSelector } from \"reselect\";\nimport { receivePost } from \"./posts\";\nconst RECEIVE_COMMENT = 'api/RECEIVECOMMENT';\nconst DELETE_COMMENT = 'api/DELETECOMMENT';\nconst RECEIVE_COMMENTS = 'api/RECEIVECOMMENTS';\n\n//actions\nexport const receiveComments = comments => ({\n  type: RECEIVE_COMMENTS,\n  comments\n});\nexport const receiveComment = comment => ({\n  type: RECEIVE_COMMENT,\n  comment\n});\nexport const deleteComment = commentId => ({\n  type: DELETE_COMMENT,\n  commentId\n});\n\n//getter \n// export const postComments = (postid) => (state) => {\n//     return state?.posts ? Object.values(state.comments).filter((comment)=> comment.postId ===postid) : null;\n\n// }\nconst getCommentState = state => state.comments;\n// export const postComments = (postid) => (state) => {\n//     return state?.posts ? Object.values(state.comments).filter((comment)=> comment.postId ===postid) : null;\n\n// }\n\nexport const postComments = postid => createSelector([getCommentState], getCommentState => {\n  return getCommentState ? getCommentState.filter(comment => comment.postId === postid) : null;\n});\n\n// export const postCommentsSelector = createSelector(\n//     getCommentState,\n//     (_,postId) => postId,\n//     postComments\n// );\n//thunk actions\n\nexport const createComment = formData => async dispatch => {\n  let response = await csrfFetch('/api/comments', {\n    body: formData,\n    method: 'POST'\n  });\n  if (response.ok) {\n    let data = await response.json();\n    dispatch(receiveComment(data.comment));\n    dispatch(receivePost(data.post));\n    return data;\n  }\n};\nexport const updateComment = (formData, commentId) => async dispatch => {\n  let response = await csrfFetch(`/api/comments/${commentId}`, {\n    body: formData,\n    method: 'PATCH'\n  });\n  if (response.ok) {\n    let data = await response.json();\n    dispatch(receiveComment(data.comment));\n  }\n};\nexport const removeComment = commentId => async dispatch => {\n  let response = await csrfFetch(`/api/comments/${commentId}`, {\n    method: 'DELETE'\n  });\n  if (response.ok) {\n    let data = await response.json();\n    dispatch(deleteComment(commentId));\n    dispatch(receivePost(data.post));\n  }\n};\nconst commentsReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  let newState = {\n    ...state\n  };\n  switch (action.type) {\n    case RECEIVE_COMMENTS:\n      return {\n        ...newState,\n        ...action.comments\n      };\n    case RECEIVE_COMMENT:\n      newState[action.comment.id] = action.comment;\n      return newState;\n    case DELETE_COMMENT:\n      delete newState[action.commentId];\n      return newState;\n    default:\n      return newState;\n  }\n};\nexport default commentsReducer;","map":{"version":3,"names":["csrfFetch","createSelector","receivePost","RECEIVE_COMMENT","DELETE_COMMENT","RECEIVE_COMMENTS","receiveComments","comments","type","receiveComment","comment","deleteComment","commentId","getCommentState","state","postComments","postid","filter","postId","createComment","formData","dispatch","response","body","method","ok","data","json","post","updateComment","removeComment","commentsReducer","arguments","length","undefined","action","newState","id"],"sources":["/Users/vincentpham/Documents/mumblr/frontend/src/store/comments.js"],"sourcesContent":["import csrfFetch from \"./csrf\"\nimport { createSelector } from \"reselect\"\nimport { receivePost } from \"./posts\"\nconst RECEIVE_COMMENT = 'api/RECEIVECOMMENT'\nconst DELETE_COMMENT = 'api/DELETECOMMENT'\nconst RECEIVE_COMMENTS= 'api/RECEIVECOMMENTS'\n\n//actions\nexport const receiveComments = (comments)=>({\n    type: RECEIVE_COMMENTS,\n    comments\n})\nexport const receiveComment = (comment)=>({\n    type: RECEIVE_COMMENT,\n    comment\n})\n\nexport const deleteComment = (commentId) => ({\n    type: DELETE_COMMENT,\n    commentId\n})\n\n//getter \n// export const postComments = (postid) => (state) => {\n//     return state?.posts ? Object.values(state.comments).filter((comment)=> comment.postId ===postid) : null;\n    \n// }\nconst getCommentState = state=> state.comments;\n// export const postComments = (postid) => (state) => {\n//     return state?.posts ? Object.values(state.comments).filter((comment)=> comment.postId ===postid) : null;\n    \n// }\n\nexport const postComments = (postid) => createSelector(\n    [getCommentState],\n    (getCommentState)=>{\n    return getCommentState ? getCommentState.filter((comment)=> comment.postId ===postid) : null;\n    }\n    \n)\n\n// export const postCommentsSelector = createSelector(\n//     getCommentState,\n//     (_,postId) => postId,\n//     postComments\n// );\n//thunk actions\n\nexport const createComment = (formData) =>async dispatch=> {\n    let response = await csrfFetch('/api/comments',{\n        body: formData,\n        method: 'POST'\n    })\n\n    if (response.ok){\n        let data = await response.json();\n        dispatch(receiveComment(data.comment));\n        dispatch(receivePost(data.post));\n        return data;\n    }\n}\n\nexport const updateComment = (formData,commentId) => async dispatch => {\n    let response = await csrfFetch(`/api/comments/${commentId}`,{\n        body: formData,\n        method: 'PATCH'\n    })\n\n    if (response.ok) {\n        let data = await response.json();\n        dispatch(receiveComment(data.comment));\n    }\n}\n\n\nexport const removeComment = (commentId) => async dispatch =>{\n    let response = await csrfFetch(`/api/comments/${commentId}`,{\n    method:'DELETE'});\n\n    if (response.ok){\n        let data = await response.json();\n        dispatch(deleteComment(commentId))\n        dispatch(receivePost(data.post));\n\n    }\n\n}\n\nconst commentsReducer = (state={},action)=>{\n    let newState={...state};\n\n    switch (action.type) {\n        case RECEIVE_COMMENTS:\n            return {...newState,...action.comments};\n\n        case RECEIVE_COMMENT:\n            newState[action.comment.id]=action.comment;\n            return newState;\n        case DELETE_COMMENT:\n            delete newState[action.commentId];\n            return newState\n        default:\n            return newState;\n    }\n}\n\nexport default commentsReducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}