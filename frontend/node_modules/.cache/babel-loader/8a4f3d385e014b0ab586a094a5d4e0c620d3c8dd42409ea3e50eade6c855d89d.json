{"ast":null,"code":"import _objectSpread from\"/Users/vincentpham/Documents/mumblr/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/vincentpham/Documents/mumblr/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/vincentpham/Documents/mumblr/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";// example of slice of state for a user\n// {\n//     user: {\n//       id,\n//       email,\n//       username,\n//       createdAt,\n//       updatedAt\n//     }\n//   }\nimport csrfFetch,{storeCSRFToken}from\"./csrf\";var SET_CURRENT_USER='session/setCurrentUser';var REMOVE_CURRENT_USER='session/removeCurrentUser';export var createSession=function createSession(user){return{type:SET_CURRENT_USER,payload:user};};var storeCurrentUser=function storeCurrentUser(user){if(user)sessionStorage.setItem(\"currentUser\",JSON.stringify(user));else sessionStorage.removeItem('currentUser');};export var removeSession=function removeSession(){return{type:REMOVE_CURRENT_USER};};export var restoreSession=function restoreSession(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return csrfFetch('/api/session');case 2:response=_context.sent;storeCSRFToken(response);_context.next=6;return response.json();case 6:data=_context.sent;storeCurrentUser(data.user);dispatch(createSession(data.user));return _context.abrupt(\"return\",response);case 10:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var signup=function signup(user){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var email,username,password,response,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:email=user.email,username=user.username,password=user.password;_context2.next=3;return csrfFetch('./api/users',{method:\"POST\",body:JSON.stringify({email:email,username:username,password:password})});case 3:response=_context2.sent;_context2.next=6;return response.json();case 6:data=_context2.sent;storeCurrentUser(data.user);dispatch(createSession(data.user));return _context2.abrupt(\"return\",response);case 10:case\"end\":return _context2.stop();}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var login=function login(user){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var email,password,response,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:email=user.email,password=user.password;_context3.next=3;return csrfFetch('./api/session',{method:\"POST\",body:JSON.stringify({email:email,password:password})});case 3:response=_context3.sent;_context3.next=6;return response.json();case 6:data=_context3.sent;storeCurrentUser(data.user);dispatch(createSession(data.user));return _context3.abrupt(\"return\",response);case 10:case\"end\":return _context3.stop();}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return csrfFetch('/api/session',{method:\"DELETE\"});case 2:response=_context4.sent;storeCurrentUser(null);dispatch(removeSession());return _context4.abrupt(\"return\",response);case 6:case\"end\":return _context4.stop();}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};var initialState={user:JSON.parse(sessionStorage.getItem(\"currentUser\"))};var sessionReducer=function sessionReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_CURRENT_USER:return _objectSpread(_objectSpread({},state),{},{user:action.payload});case REMOVE_CURRENT_USER:return _objectSpread(_objectSpread({},state),{},{user:null});default:return state;}};export default sessionReducer;","map":{"version":3,"names":["csrfFetch","storeCSRFToken","SET_CURRENT_USER","REMOVE_CURRENT_USER","createSession","user","type","payload","storeCurrentUser","sessionStorage","setItem","JSON","stringify","removeItem","removeSession","restoreSession","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","response","data","wrap","_callee$","_context","prev","next","sent","json","abrupt","stop","_x","apply","arguments","signup","_ref2","_callee2","email","username","password","_callee2$","_context2","method","body","_x2","login","_ref3","_callee3","_callee3$","_context3","_x3","logout","_ref4","_callee4","_callee4$","_context4","_x4","initialState","parse","getItem","sessionReducer","state","length","undefined","action","_objectSpread"],"sources":["/Users/vincentpham/Documents/mumblr/frontend/src/store/session.js"],"sourcesContent":["// example of slice of state for a user\n// {\n//     user: {\n//       id,\n//       email,\n//       username,\n//       createdAt,\n//       updatedAt\n//     }\n//   }\nimport csrfFetch, { storeCSRFToken } from \"./csrf\";\nconst SET_CURRENT_USER = 'session/setCurrentUser';\nconst REMOVE_CURRENT_USER = 'session/removeCurrentUser';\n\n\nexport const createSession = (user) => {\n    return {\n        type: SET_CURRENT_USER,\n        payload: user\n    }\n\n}\n\nconst storeCurrentUser = user => {\n    if (user) sessionStorage.setItem(\"currentUser\",JSON.stringify(user));\n    else sessionStorage.removeItem('currentUser');\n}\n\nexport const removeSession = ()=> {\n    return {\n        type: REMOVE_CURRENT_USER\n    }\n}\n\nexport const restoreSession = () => async dispatch => {\n    const response =await csrfFetch('/api/session');\n    storeCSRFToken(response);\n    const data = await response.json();\n    storeCurrentUser(data.user);\n    dispatch(createSession(data.user));\n    return response;\n    \n}\nexport const signup =(user)=> async(dispatch) => {\n    const {email,username,password} = user;\n    const response = await csrfFetch('./api/users',{\n        method:\"POST\",\n        body: JSON.stringify({email,username,password})\n    });\n    const data = await response.json();\n    storeCurrentUser(data.user);\n    dispatch(createSession(data.user));\n    return response;\n}\nexport const login =(user)=> async(dispatch) => {\n    const {email,password} = user;\n    const response = await csrfFetch('./api/session',{\n        method:\"POST\",\n        body: JSON.stringify({email,password})\n    });\n    const data = await response.json();\n    storeCurrentUser(data.user);\n    dispatch(createSession(data.user));\n    return response;\n}\nexport const logout = () => async (dispatch) => {\n    const response = await csrfFetch('/api/session', {\n      method: \"DELETE\"\n    });\n    storeCurrentUser(null);\n    dispatch(removeSession());\n    return response;\n  }\nconst initialState = {user: JSON.parse(sessionStorage.getItem(\"currentUser\"))};\n\nconst sessionReducer = (state=initialState,action)=> {\n    switch (action.type) {\n        case SET_CURRENT_USER:\n            return {...state,user: action.payload}\n        case REMOVE_CURRENT_USER:\n            return{...state, user: null};\n        default:\n            return state;\n    }\n}\n\nexport default sessionReducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}