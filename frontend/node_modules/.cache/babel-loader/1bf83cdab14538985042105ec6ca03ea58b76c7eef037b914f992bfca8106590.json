{"ast":null,"code":"// consts\n\nimport csrfFetch from \"./csrf\";\nimport { receivePost, receiveUserPosts } from \"./posts\";\nconst RECEIVE_USER = 'api/RECEIVEUSER';\nconst DELETE_USER = 'api/DELETEUSER';\nconst RECEIVE_USERS = 'api/RECEIVEUSERS';\n\n//action types\n\nexport const receiveUser = payload => ({\n  type: RECEIVE_USER,\n  user: payload\n});\nexport const receiveUsers = users => ({\n  type: RECEIVE_USERS,\n  users\n});\nexport const deleteUser = userId => ({\n  type: DELETE_USER,\n  userId\n});\n\n//gett\nexport const getUser = id => state => {\n  return state !== null && state !== void 0 && state.users ? state.users[id] : null;\n};\nexport const fetchUsers = () => async dispatch => {\n  let response = await fetch(`/api/users`);\n  if (response.ok) {\n    const users = await response.json();\n    dispatch(receiveUsers(users));\n    return users;\n  }\n};\nexport const fetchUser = id => async dispatch => {\n  // debugger\n  let response = await fetch(`/api/users/${id}`);\n  if (response.ok) {\n    const data = await response.json();\n    dispatch(receiveUser(data.user));\n    dispatch(receiveUserPosts(data.posts));\n    return data;\n  }\n};\nexport const removeUser = userid => async dispatch => {\n  const response = await csrfFetch(`/api/users/${userid}`, {\n    method: 'DELETE'\n  });\n  if (response.ok) {\n    //when a user deletes i will call logout and then destroy\n    dispatch(deleteUser(userid));\n  }\n};\n\n//users reducer\n\nconst userReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  const newState = {\n    ...state\n  };\n  switch (action.type) {\n    case RECEIVE_USERS:\n      return {\n        ...state,\n        ...action.users\n      };\n    case RECEIVE_USER:\n      newState[action.user.id] = action.user;\n      return newState;\n    case DELETE_USER:\n      delete newState[action.user.username];\n      return newState;\n    default:\n      return newState;\n  }\n};\nexport default userReducer;","map":{"version":3,"names":["csrfFetch","receivePost","receiveUserPosts","RECEIVE_USER","DELETE_USER","RECEIVE_USERS","receiveUser","payload","type","user","receiveUsers","users","deleteUser","userId","getUser","id","state","fetchUsers","dispatch","response","fetch","ok","json","fetchUser","data","posts","removeUser","userid","method","userReducer","arguments","length","undefined","action","newState","username"],"sources":["/Users/vincentpham/Documents/mumblr/frontend/src/store/user.js"],"sourcesContent":["\n// consts\n\nimport csrfFetch from \"./csrf\";\nimport { receivePost, receiveUserPosts } from \"./posts\";\nconst RECEIVE_USER = 'api/RECEIVEUSER'\nconst DELETE_USER = 'api/DELETEUSER'\nconst RECEIVE_USERS = 'api/RECEIVEUSERS'\n\n//action types\n\nexport const receiveUser = (payload) => ({\n    type: RECEIVE_USER,\n    user: payload\n})\n\nexport const receiveUsers = (users) =>({\n    type: RECEIVE_USERS,\n    users\n})\nexport const deleteUser = (userId) => ({\n    type:DELETE_USER,\n    userId\n});\n\n//gett\nexport const getUser = id => state =>{\n    return state?.users ? state.users[id] : null;\n    \n}\nexport const fetchUsers =() => async(dispatch) => {\n    let response = await fetch(`/api/users`)\n    if (response.ok){\n        const users = await response.json();\n        dispatch(receiveUsers(users));\n        return users;\n    }\n}\nexport const fetchUser = (id) => async(dispatch) =>{\n    // debugger\n    let response = await fetch(`/api/users/${id}`)\n    if (response.ok){\n        const data = await response.json();\n        dispatch(receiveUser(data.user));\n        dispatch(receiveUserPosts(data.posts));\n        return data;\n    }\n\n}\n\nexport const removeUser = (userid) => async (dispatch) => {\n    const response = await csrfFetch(`/api/users/${userid}`,{\n        method: 'DELETE'\n    });\n    if (response.ok){\n        //when a user deletes i will call logout and then destroy\n        dispatch(deleteUser(userid))\n    }\n};\n\n//users reducer\n\nconst userReducer = (state={},action) => {\n    const newState={...state};\n    switch (action.type) {\n        case RECEIVE_USERS:\n            return {...state, ...action.users}; \n\n        case RECEIVE_USER:\n            newState[action.user.id]=action.user;\n            return newState;\n        case DELETE_USER:\n            delete newState[action.user.username];\n            return newState;\n        default:\n            return newState;\n    }\n\n}\n\nexport default userReducer;\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}