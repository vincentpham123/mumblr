{"ast":null,"code":"const csrfFetch = async function (url) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  options.method = options.method || 'GET';\n  options.headers = options.headers || {};\n  if (options.method.toUpperCase() !== 'GET') {\n    options.headers['Content-Type'] = options.headers['Content-Type'] || 'application/json';\n    options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n  }\n\n  // initial fetch \n  const res = await fetch(url, options);\n  if (res.status >= 400) throw res;\n  // returns promise for the action\n\n  return res;\n};\nexport const storeCSRFToken = response => {\n  const csrfToken = response.headers.get('X-CSRF-Token');\n  if (csrfToken) sessionStorage.setItem(\"X-CSRF-Token\", csrfToken);\n};\nexport const restoreCSRF = async () => {\n  const res = await csrfFetch('/api/session');\n  storeCSRFToken(res);\n  return res;\n};\nexport default csrfFetch;","map":{"version":3,"names":["csrfFetch","url","options","arguments","length","undefined","method","headers","toUpperCase","sessionStorage","getItem","res","fetch","status","storeCSRFToken","response","csrfToken","get","setItem","restoreCSRF"],"sources":["/Users/vincentpham/Documents/mumblr/frontend/src/store/csrf.js"],"sourcesContent":["\nconst csrfFetch = async(url, options={}) => {\n    options.method = options.method || 'GET';\n    options.headers = options.headers || {};\n\n    if (options.method.toUpperCase()!=='GET'){\n        options.headers['Content-Type'] = options.headers['Content-Type'] || 'application/json';\n        options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n    }\n\n    // initial fetch \n    const res = await fetch(url, options);\n\n    if (res.status>=400) throw res; \n    // returns promise for the action\n\n    return res;\n}\nexport const storeCSRFToken = (response) => {\n    const csrfToken = response.headers.get('X-CSRF-Token');\n    if (csrfToken) sessionStorage.setItem(\"X-CSRF-Token\",csrfToken);\n}\nexport const restoreCSRF = async()=>{\n    const res = await csrfFetch('/api/session')\n    storeCSRFToken(res);\n    return res;\n}\n\nexport default csrfFetch;\n"],"mappings":"AACA,MAAMA,SAAS,GAAG,eAAAA,CAAMC,GAAG,EAAiB;EAAA,IAAfC,OAAO,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAC,CAAC,CAAC;EACnCD,OAAO,CAACI,MAAM,GAAGJ,OAAO,CAACI,MAAM,IAAI,KAAK;EACxCJ,OAAO,CAACK,OAAO,GAAGL,OAAO,CAACK,OAAO,IAAI,CAAC,CAAC;EAEvC,IAAIL,OAAO,CAACI,MAAM,CAACE,WAAW,CAAC,CAAC,KAAG,KAAK,EAAC;IACrCN,OAAO,CAACK,OAAO,CAAC,cAAc,CAAC,GAAGL,OAAO,CAACK,OAAO,CAAC,cAAc,CAAC,IAAI,kBAAkB;IACvFL,OAAO,CAACK,OAAO,CAAC,cAAc,CAAC,GAAGE,cAAc,CAACC,OAAO,CAAC,cAAc,CAAC;EAC5E;;EAEA;EACA,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAACX,GAAG,EAAEC,OAAO,CAAC;EAErC,IAAIS,GAAG,CAACE,MAAM,IAAE,GAAG,EAAE,MAAMF,GAAG;EAC9B;;EAEA,OAAOA,GAAG;AACd,CAAC;AACD,OAAO,MAAMG,cAAc,GAAIC,QAAQ,IAAK;EACxC,MAAMC,SAAS,GAAGD,QAAQ,CAACR,OAAO,CAACU,GAAG,CAAC,cAAc,CAAC;EACtD,IAAID,SAAS,EAAEP,cAAc,CAACS,OAAO,CAAC,cAAc,EAACF,SAAS,CAAC;AACnE,CAAC;AACD,OAAO,MAAMG,WAAW,GAAG,MAAAA,CAAA,KAAS;EAChC,MAAMR,GAAG,GAAG,MAAMX,SAAS,CAAC,cAAc,CAAC;EAC3Cc,cAAc,CAACH,GAAG,CAAC;EACnB,OAAOA,GAAG;AACd,CAAC;AAED,eAAeX,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}