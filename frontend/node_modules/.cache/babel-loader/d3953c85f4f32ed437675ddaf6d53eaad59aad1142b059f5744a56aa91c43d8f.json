{"ast":null,"code":"const csrfFetch = async (url, options) => {\n  options.method ||= 'GET';\n  options.header ||= {};\n  if (options.method.toTupperCase() !== 'GET') {\n    options.headers['Content-Type'] = options.headers['Content-Type'] || 'application/json';\n    options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n  }\n\n  // initial fetch \n  const res = await fetch(url, options);\n  if (res.status >= 400) throw res;\n  // returns promise for the action\n\n  return res;\n};\nexport const storeCSRFToken = response => {\n  const csrfToken = response.headers.get('X-CSRF-Token');\n  if (csrfToken) sessionStorage.setItem(\"X-CSRF-Token\", csrfToken);\n};\nexport const restoreCSRF = async () => {\n  const res = await csrfFetch('/api/session');\n  storeCSRFToken(response);\n  return response;\n};\nexport default csrfFetch;","map":{"version":3,"names":["csrfFetch","url","options","method","header","toTupperCase","headers","sessionStorage","getItem","res","fetch","status","storeCSRFToken","response","csrfToken","get","setItem","restoreCSRF"],"sources":["/Users/vincentpham/Documents/GitHub/fullstack/frontend_react/frontend/src/store/csrf.js"],"sourcesContent":["\nconst csrfFetch = async(url, options) => {\n    options.method ||= 'GET';\n    options.header ||= {};\n\n    if (options.method.toTupperCase()!=='GET'){\n        options.headers['Content-Type'] = \n            options.headers['Content-Type'] || 'application/json';\n        options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n    }\n\n    // initial fetch \n    const res = await fetch(url, options);\n\n    if (res.status>=400) throw res; \n    // returns promise for the action\n\n    return res;\n}\nexport const storeCSRFToken = (response) => {\n    const csrfToken = response.headers.get('X-CSRF-Token');\n    if (csrfToken) sessionStorage.setItem(\"X-CSRF-Token\",csrfToken);\n}\nexport const restoreCSRF = async()=>{\n    const res = await csrfFetch('/api/session')\n    storeCSRFToken(response);\n    return response;\n}\n\nexport default csrfFetch;"],"mappings":"AACA,MAAMA,SAAS,GAAG,MAAAA,CAAMC,GAAG,EAAEC,OAAO,KAAK;EACrCA,OAAO,CAACC,MAAM,KAAK,KAAK;EACxBD,OAAO,CAACE,MAAM,KAAK,CAAC,CAAC;EAErB,IAAIF,OAAO,CAACC,MAAM,CAACE,YAAY,CAAC,CAAC,KAAG,KAAK,EAAC;IACtCH,OAAO,CAACI,OAAO,CAAC,cAAc,CAAC,GAC3BJ,OAAO,CAACI,OAAO,CAAC,cAAc,CAAC,IAAI,kBAAkB;IACzDJ,OAAO,CAACI,OAAO,CAAC,cAAc,CAAC,GAAGC,cAAc,CAACC,OAAO,CAAC,cAAc,CAAC;EAC5E;;EAEA;EACA,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAACT,GAAG,EAAEC,OAAO,CAAC;EAErC,IAAIO,GAAG,CAACE,MAAM,IAAE,GAAG,EAAE,MAAMF,GAAG;EAC9B;;EAEA,OAAOA,GAAG;AACd,CAAC;AACD,OAAO,MAAMG,cAAc,GAAIC,QAAQ,IAAK;EACxC,MAAMC,SAAS,GAAGD,QAAQ,CAACP,OAAO,CAACS,GAAG,CAAC,cAAc,CAAC;EACtD,IAAID,SAAS,EAAEP,cAAc,CAACS,OAAO,CAAC,cAAc,EAACF,SAAS,CAAC;AACnE,CAAC;AACD,OAAO,MAAMG,WAAW,GAAG,MAAAA,CAAA,KAAS;EAChC,MAAMR,GAAG,GAAG,MAAMT,SAAS,CAAC,cAAc,CAAC;EAC3CY,cAAc,CAACC,QAAQ,CAAC;EACxB,OAAOA,QAAQ;AACnB,CAAC;AAED,eAAeb,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}