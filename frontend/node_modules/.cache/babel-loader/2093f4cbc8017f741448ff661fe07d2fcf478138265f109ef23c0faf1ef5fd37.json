{"ast":null,"code":"// const csrfFetch = async(url, options={}) => {\n//     options.method = options.method || 'GET';\n//     options.headers = options.headers || {};\n\n//     if (options.method.toUpperCase()!=='GET'){\n//         options.headers['Content-Type'] = options.headers['Content-Type'] || 'application/json';\n//         options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n//     }\n\n//     // initial fetch \n//     const res = await fetch(url, options);\n\n//     if (res.status>=400) throw res; \n//     // returns promise for the action\n\n//     return res;\n// }\nconst csrfFetch = async function (url) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  options.method = options.method || 'GET';\n  options.headers = options.headers || {};\n  if (options.method.toUpperCase() !== 'GET') {\n    if (!options.headers['Content-Type'] && !(options.body instanceof FormData)) {\n      options.headers['Content-Type'] = 'application/json';\n    }\n    options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n  }\n\n  // initial fetch \n  const res = await fetch(url, options);\n  if (res.status >= 400) throw res;\n  // returns promise for the action\n\n  return res;\n};\nexport const storeCSRFToken = response => {\n  const csrfToken = response.headers.get('X-CSRF-Token');\n  if (csrfToken) sessionStorage.setItem(\"X-CSRF-Token\", csrfToken);\n};\nexport const restoreCSRF = async () => {\n  const res = await csrfFetch('/api/session');\n  storeCSRFToken(res);\n  return res;\n};\nexport default csrfFetch;","map":{"version":3,"names":["csrfFetch","url","options","arguments","length","undefined","method","headers","toUpperCase","body","FormData","sessionStorage","getItem","res","fetch","status","storeCSRFToken","response","csrfToken","get","setItem","restoreCSRF"],"sources":["/Users/vincentpham/Documents/mumblr/frontend/src/store/csrf.js"],"sourcesContent":["\n// const csrfFetch = async(url, options={}) => {\n//     options.method = options.method || 'GET';\n//     options.headers = options.headers || {};\n\n//     if (options.method.toUpperCase()!=='GET'){\n//         options.headers['Content-Type'] = options.headers['Content-Type'] || 'application/json';\n//         options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n//     }\n\n//     // initial fetch \n//     const res = await fetch(url, options);\n\n//     if (res.status>=400) throw res; \n//     // returns promise for the action\n\n//     return res;\n// }\nconst csrfFetch = async(url, options={}) => {\n    options.method = options.method || 'GET';\n    options.headers = options.headers || {};\n\n    if (options.method.toUpperCase()!=='GET'){\n       if (!options.headers['Content-Type'] && !(options.body instanceof FormData)){ \n        options.headers['Content-Type'] = 'application/json';\n       }\n        options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n    }\n\n    // initial fetch \n    const res = await fetch(url, options);\n\n    if (res.status>=400) throw res; \n    // returns promise for the action\n\n    return res;\n}\n\nexport const storeCSRFToken = (response) => {\n    const csrfToken = response.headers.get('X-CSRF-Token');\n    if (csrfToken) sessionStorage.setItem(\"X-CSRF-Token\",csrfToken);\n}\nexport const restoreCSRF = async()=>{\n    const res = await csrfFetch('/api/session')\n    storeCSRFToken(res);\n    return res;\n}\n\nexport default csrfFetch;\n"],"mappings":"AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAMA,SAAS,GAAG,eAAAA,CAAMC,GAAG,EAAiB;EAAA,IAAfC,OAAO,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAC,CAAC,CAAC;EACnCD,OAAO,CAACI,MAAM,GAAGJ,OAAO,CAACI,MAAM,IAAI,KAAK;EACxCJ,OAAO,CAACK,OAAO,GAAGL,OAAO,CAACK,OAAO,IAAI,CAAC,CAAC;EAEvC,IAAIL,OAAO,CAACI,MAAM,CAACE,WAAW,CAAC,CAAC,KAAG,KAAK,EAAC;IACtC,IAAI,CAACN,OAAO,CAACK,OAAO,CAAC,cAAc,CAAC,IAAI,EAAEL,OAAO,CAACO,IAAI,YAAYC,QAAQ,CAAC,EAAC;MAC3ER,OAAO,CAACK,OAAO,CAAC,cAAc,CAAC,GAAG,kBAAkB;IACrD;IACCL,OAAO,CAACK,OAAO,CAAC,cAAc,CAAC,GAAGI,cAAc,CAACC,OAAO,CAAC,cAAc,CAAC;EAC5E;;EAEA;EACA,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAACb,GAAG,EAAEC,OAAO,CAAC;EAErC,IAAIW,GAAG,CAACE,MAAM,IAAE,GAAG,EAAE,MAAMF,GAAG;EAC9B;;EAEA,OAAOA,GAAG;AACd,CAAC;AAED,OAAO,MAAMG,cAAc,GAAIC,QAAQ,IAAK;EACxC,MAAMC,SAAS,GAAGD,QAAQ,CAACV,OAAO,CAACY,GAAG,CAAC,cAAc,CAAC;EACtD,IAAID,SAAS,EAAEP,cAAc,CAACS,OAAO,CAAC,cAAc,EAACF,SAAS,CAAC;AACnE,CAAC;AACD,OAAO,MAAMG,WAAW,GAAG,MAAAA,CAAA,KAAS;EAChC,MAAMR,GAAG,GAAG,MAAMb,SAAS,CAAC,cAAc,CAAC;EAC3CgB,cAAc,CAACH,GAAG,CAAC;EACnB,OAAOA,GAAG;AACd,CAAC;AAED,eAAeb,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}