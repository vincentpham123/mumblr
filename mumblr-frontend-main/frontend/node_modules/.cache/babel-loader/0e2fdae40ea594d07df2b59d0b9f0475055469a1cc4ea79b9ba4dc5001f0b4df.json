{"ast":null,"code":"// example of slice of state for a user\n// {\n//     user: {\n//       id,\n//       email,\n//       username,\n//       createdAt,\n//       updatedAt\n//     }\n//   }\nimport csrfFetch, { storeCSRFToken } from \"./csrf\";\nconst SET_CURRENT_USER = 'session/setCurrentUser';\nconst REMOVE_CURRENT_USER = 'session/removeCurrentUser';\nexport const createSession = user => {\n  return {\n    type: SET_CURRENT_USER,\n    payload: user\n  };\n};\nconst storeCurrentUser = user => {\n  if (user) sessionStorage.setItem(\"currentUser\", JSON.stringify(user));else sessionStorage.removeItem('currentUser');\n};\nexport const removeSession = () => {\n  return {\n    type: REMOVE_CURRENT_USER\n  };\n};\nexport const checkEmail = email => async dispatch => {\n  const response = await csrfFetch('./api/test', {\n    method: \"POST\",\n    body: JSON.stringify(email)\n  });\n  const exists = await response.json();\n  return;\n};\nexport const restoreSession = () => async dispatch => {\n  const response = await csrfFetch('/api/session');\n  storeCSRFToken(response);\n  const data = await response.json();\n  storeCurrentUser(data.user);\n  dispatch(createSession(data.user));\n  return response;\n};\nexport const signup = user => async dispatch => {\n  const {\n    email,\n    username,\n    password\n  } = user;\n  const response = await csrfFetch('./api/users', {\n    method: \"POST\",\n    body: JSON.stringify({\n      email,\n      username,\n      password\n    })\n  });\n  const data = await response.json();\n  storeCurrentUser(data.user);\n  dispatch(createSession(data.user));\n  return response;\n};\nexport const login = user => async dispatch => {\n  const {\n    credential,\n    password\n  } = user;\n  const response = await csrfFetch('./api/session', {\n    method: \"POST\",\n    body: JSON.stringify({\n      credential,\n      password\n    })\n  });\n  const data = await response.json();\n  storeCurrentUser(data.user);\n  dispatch(createSession(data.user));\n  return response;\n};\nexport const logout = () => async dispatch => {\n  const response = await csrfFetch('/api/session', {\n    method: \"DELETE\"\n  });\n  storeCurrentUser(null);\n  dispatch(removeSession());\n  return response;\n};\nconst initialState = {\n  user: JSON.parse(sessionStorage.getItem(\"currentUser\"))\n};\nconst sessionReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  switch (action.type) {\n    case SET_CURRENT_USER:\n      return {\n        ...state,\n        user: action.payload\n      };\n    case REMOVE_CURRENT_USER:\n      return {\n        ...state,\n        user: null\n      };\n    default:\n      return state;\n  }\n};\nexport default sessionReducer;","map":{"version":3,"names":["csrfFetch","storeCSRFToken","SET_CURRENT_USER","REMOVE_CURRENT_USER","createSession","user","type","payload","storeCurrentUser","sessionStorage","setItem","JSON","stringify","removeItem","removeSession","checkEmail","email","dispatch","response","method","body","exists","json","restoreSession","data","signup","username","password","login","credential","logout","initialState","parse","getItem","sessionReducer","state","arguments","length","undefined","action"],"sources":["/Users/vincentpham/Documents/GitHub/fullstack/frontend_react/frontend/src/store/session.js"],"sourcesContent":["// example of slice of state for a user\n// {\n//     user: {\n//       id,\n//       email,\n//       username,\n//       createdAt,\n//       updatedAt\n//     }\n//   }\nimport csrfFetch, { storeCSRFToken } from \"./csrf\";\nconst SET_CURRENT_USER = 'session/setCurrentUser';\nconst REMOVE_CURRENT_USER = 'session/removeCurrentUser';\n\n\nexport const createSession = (user) => {\n    return {\n        type: SET_CURRENT_USER,\n        payload: user\n    }\n\n}\n\nconst storeCurrentUser = user => {\n    if (user) sessionStorage.setItem(\"currentUser\",JSON.stringify(user));\n    else sessionStorage.removeItem('currentUser');\n}\n\nexport const removeSession = ()=> {\n    return {\n        type: REMOVE_CURRENT_USER\n    }\n}\nexport const checkEmail = (email) => async dispatch =>{\n    const response = await csrfFetch('./api/test',{\n        method:\"POST\",\n        body: JSON.stringify(email)\n    });\n    const exists = await response.json();\n    return \n\n}\nexport const restoreSession = () => async dispatch => {\n    const response =await csrfFetch('/api/session');\n    storeCSRFToken(response);\n    const data = await response.json();\n    storeCurrentUser(data.user);\n    dispatch(createSession(data.user));\n    return response;\n    \n}\nexport const signup =(user)=> async(dispatch) => {\n    const {email,username,password} = user;\n    const response = await csrfFetch('./api/users',{\n        method:\"POST\",\n        body: JSON.stringify({email,username,password})\n    });\n    const data = await response.json();\n    storeCurrentUser(data.user);\n    dispatch(createSession(data.user));\n    return response;\n}\nexport const login =(user)=> async(dispatch) => {\n    const {credential,password} = user;\n    const response = await csrfFetch('./api/session',{\n        method:\"POST\",\n        body: JSON.stringify({credential,password})\n    });\n    const data = await response.json();\n    storeCurrentUser(data.user);\n    dispatch(createSession(data.user));\n    return response;\n}\nexport const logout = () => async (dispatch) => {\n    const response = await csrfFetch('/api/session', {\n      method: \"DELETE\"\n    });\n    storeCurrentUser(null);\n    dispatch(removeSession());\n    return response;\n  }\nconst initialState = {user: JSON.parse(sessionStorage.getItem(\"currentUser\"))};\n\nconst sessionReducer = (state=initialState,action)=> {\n    switch (action.type) {\n        case SET_CURRENT_USER:\n            return {...state,user: action.payload}\n        case REMOVE_CURRENT_USER:\n            return{...state, user: null};\n        default:\n            return state;\n    }\n}\n\nexport default sessionReducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}