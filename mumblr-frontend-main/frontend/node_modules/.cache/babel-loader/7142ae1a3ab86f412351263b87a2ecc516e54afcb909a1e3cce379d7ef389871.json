{"ast":null,"code":"import _regeneratorRuntime from\"/Users/vincentpham/Documents/GitHub/fullstack/frontend_react/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/vincentpham/Documents/GitHub/fullstack/frontend_react/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var csrfFetch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(url){var options,res,_args=arguments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:options=_args.length>1&&_args[1]!==undefined?_args[1]:{};options.method=options.method||'GET';options.headers=options.headers||{};if(options.method.toUpperCase()!=='GET'){options.headers['Content-Type']=options.headers['Content-Type']||'application/json';options.headers['X-CSRF-Token']=sessionStorage.getItem('X-CSRF-Token');}// initial fetch \n_context.next=6;return fetch(url,options);case 6:res=_context.sent;if(!(res.status>=400)){_context.next=9;break;}throw res;case 9:return _context.abrupt(\"return\",res);case 10:case\"end\":return _context.stop();}},_callee);}));return function csrfFetch(_x){return _ref.apply(this,arguments);};}();export var storeCSRFToken=function storeCSRFToken(response){var csrfToken=response.headers.get('X-CSRF-Token');if(csrfToken)sessionStorage.setItem(\"X-CSRF-Token\",csrfToken);};export var restoreCSRF=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return csrfFetch('/api/session');case 2:res=_context2.sent;storeCSRFToken(res);return _context2.abrupt(\"return\",res);case 5:case\"end\":return _context2.stop();}},_callee2);}));return function restoreCSRF(){return _ref2.apply(this,arguments);};}();export default csrfFetch;","map":{"version":3,"names":["csrfFetch","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","url","options","res","_args","arguments","wrap","_callee$","_context","prev","next","length","undefined","method","headers","toUpperCase","sessionStorage","getItem","fetch","sent","status","abrupt","stop","_x","apply","storeCSRFToken","response","csrfToken","get","setItem","restoreCSRF","_ref2","_callee2","_callee2$","_context2"],"sources":["/Users/vincentpham/Documents/GitHub/fullstack/frontend_react/frontend/src/store/csrf.js"],"sourcesContent":["\nconst csrfFetch = async(url, options={}) => {\n    options.method = options.method || 'GET';\n    options.headers = options.headers || {};\n\n    if (options.method.toUpperCase()!=='GET'){\n        options.headers['Content-Type'] = options.headers['Content-Type'] || 'application/json';\n        options.headers['X-CSRF-Token'] = sessionStorage.getItem('X-CSRF-Token');\n    }\n\n    // initial fetch \n    const res = await fetch(url, options);\n\n    if (res.status>=400) throw res; \n    // returns promise for the action\n\n    return res;\n}\nexport const storeCSRFToken = (response) => {\n    const csrfToken = response.headers.get('X-CSRF-Token');\n    if (csrfToken) sessionStorage.setItem(\"X-CSRF-Token\",csrfToken);\n}\nexport const restoreCSRF = async()=>{\n    const res = await csrfFetch('/api/session')\n    storeCSRFToken(res);\n    return res;\n}\n\nexport default csrfFetch;\n"],"mappings":"sUACA,GAAM,CAAAA,SAAS,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAMC,GAAG,MAAAC,OAAA,CAAAC,GAAA,CAAAC,KAAA,CAAAC,SAAA,QAAAP,mBAAA,GAAAQ,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAER,OAAO,CAAAE,KAAA,CAAAO,MAAA,IAAAP,KAAA,MAAAQ,SAAA,CAAAR,KAAA,IAAC,CAAC,CAAC,CACnCF,OAAO,CAACW,MAAM,CAAGX,OAAO,CAACW,MAAM,EAAI,KAAK,CACxCX,OAAO,CAACY,OAAO,CAAGZ,OAAO,CAACY,OAAO,EAAI,CAAC,CAAC,CAEvC,GAAIZ,OAAO,CAACW,MAAM,CAACE,WAAW,CAAC,CAAC,GAAG,KAAK,CAAC,CACrCb,OAAO,CAACY,OAAO,CAAC,cAAc,CAAC,CAAGZ,OAAO,CAACY,OAAO,CAAC,cAAc,CAAC,EAAI,kBAAkB,CACvFZ,OAAO,CAACY,OAAO,CAAC,cAAc,CAAC,CAAGE,cAAc,CAACC,OAAO,CAAC,cAAc,CAAC,CAC5E,CAEA;AAAAT,QAAA,CAAAE,IAAA,SACkB,CAAAQ,KAAK,CAACjB,GAAG,CAAEC,OAAO,CAAC,QAA/BC,GAAG,CAAAK,QAAA,CAAAW,IAAA,MAELhB,GAAG,CAACiB,MAAM,EAAE,GAAG,GAAAZ,QAAA,CAAAE,IAAA,eAAQ,CAAAP,GAAG,eAAAK,QAAA,CAAAa,MAAA,UAGvBlB,GAAG,2BAAAK,QAAA,CAAAc,IAAA,MAAAtB,OAAA,GACb,kBAhBK,CAAAL,SAASA,CAAA4B,EAAA,SAAA3B,IAAA,CAAA4B,KAAA,MAAAnB,SAAA,OAgBd,CACD,MAAO,IAAM,CAAAoB,cAAc,CAAG,QAAjB,CAAAA,cAAcA,CAAIC,QAAQ,CAAK,CACxC,GAAM,CAAAC,SAAS,CAAGD,QAAQ,CAACZ,OAAO,CAACc,GAAG,CAAC,cAAc,CAAC,CACtD,GAAID,SAAS,CAAEX,cAAc,CAACa,OAAO,CAAC,cAAc,CAACF,SAAS,CAAC,CACnE,CAAC,CACD,MAAO,IAAM,CAAAG,WAAW,6BAAAC,KAAA,CAAAlC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAiC,SAAA,MAAA7B,GAAA,QAAAL,mBAAA,GAAAQ,IAAA,UAAA2B,UAAAC,SAAA,iBAAAA,SAAA,CAAAzB,IAAA,CAAAyB,SAAA,CAAAxB,IAAA,SAAAwB,SAAA,CAAAxB,IAAA,SACL,CAAAf,SAAS,CAAC,cAAc,CAAC,QAArCQ,GAAG,CAAA+B,SAAA,CAAAf,IAAA,CACTM,cAAc,CAACtB,GAAG,CAAC,CAAC,OAAA+B,SAAA,CAAAb,MAAA,UACblB,GAAG,0BAAA+B,SAAA,CAAAZ,IAAA,MAAAU,QAAA,GACb,kBAJY,CAAAF,WAAWA,CAAA,SAAAC,KAAA,CAAAP,KAAA,MAAAnB,SAAA,OAIvB,CAED,cAAe,CAAAV,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}